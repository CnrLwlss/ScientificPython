<pre><font face="Lucida,Courier New"><font color="#C00000">import</font> <font color="#000000">random</font><font color="#0000C0">,</font> <font color="#000000">numpy</font><font color="#0000C0">,</font> <font color="#000000">string</font>

<font color="#000000">target</font><font color="#0000C0">=</font><font color="#004080">"Tree"</font>
<font color="#000000">NRows</font><font color="#0000C0">,</font><font color="#000000">NCols</font><font color="#0000C0">=</font><font color="#0080C0">20</font><font color="#0000C0">,</font><font color="#0080C0">20</font>
<font color="#000000">printsol</font><font color="#0000C0">=</font><font color="#000000">True</font>

<font color="#008000"># Format target and convert it to a list of uppercase letters</font>
<font color="#000000">target</font><font color="#0000C0">=</font><font color="#000000">target</font><font color="#0000C0">.</font><font color="#000000">replace</font><font color="#0000C0">(</font><font color="#004080">" "</font><font color="#0000C0">,</font><font color="#004080">""</font><font color="#0000C0">)</font>
<font color="#000000">target</font><font color="#0000C0">=</font><font color="#000000">target</font><font color="#0000C0">.</font><font color="#000000">upper</font><font color="#0000C0">(</font><font color="#0000C0">)</font>

<font color="#008000"># Define alphabet as set of letters in target</font>
<font color="#000000">listarr</font><font color="#0000C0">=</font><font color="#000000">list</font><font color="#0000C0">(</font><font color="#000000">set</font><font color="#0000C0">(</font><font color="#000000">target</font><font color="#0000C0">)</font><font color="#0000C0">)</font>

<font color="#008000"># Generate and fill a two-dimensional array of letters randomly selected</font>
<font color="#000000">store</font><font color="#0000C0">=</font><font color="#000000">numpy</font><font color="#0000C0">.</font><font color="#000000">random</font><font color="#0000C0">.</font><font color="#000000">choice</font><font color="#0000C0">(</font><font color="#000000">listarr</font><font color="#0000C0">,</font><font color="#000000">size</font><font color="#0000C0">=</font><font color="#0000C0">(</font><font color="#000000">NRows</font><font color="#0000C0">,</font><font color="#000000">NCols</font><font color="#0000C0">)</font><font color="#0000C0">,</font><font color="#000000">replace</font><font color="#0000C0">=</font><font color="#000000">True</font><font color="#0000C0">)</font>

<font color="#008000"># Check if there are any vertical solutions</font>
<font color="#000000">vpos</font><font color="#0000C0">=</font><font color="#0000C0">[</font><font color="#0080C0">0</font><font color="#0000C0">]</font><font color="#0000C0">*</font><font color="#000000">NCols</font><font color="#0000C0">;</font> <font color="#000000">vneg</font><font color="#0000C0">=</font><font color="#0000C0">[</font><font color="#0080C0">0</font><font color="#0000C0">]</font><font color="#0000C0">*</font><font color="#000000">NCols</font>
<font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">xrange</font><font color="#0000C0">(</font><font color="#000000">NCols</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
    <font color="#000000">bigword</font><font color="#0000C0">=</font><font color="#004080">""</font><font color="#0000C0">.</font><font color="#000000">join</font><font color="#0000C0">(</font><font color="#000000">store</font><font color="#0000C0">[</font><font color="#0000C0">:</font><font color="#0000C0">,</font><font color="#000000">x</font><font color="#0000C0">]</font><font color="#0000C0">)</font>
    <font color="#000000">vpos</font><font color="#0000C0">[</font><font color="#000000">x</font><font color="#0000C0">]</font><font color="#0000C0">=</font><font color="#000000">bigword</font><font color="#0000C0">.</font><font color="#000000">count</font><font color="#0000C0">(</font><font color="#000000">target</font><font color="#0000C0">)</font> <font color="#008000"># Positive (or forward) solution</font>
    <font color="#000000">vneg</font><font color="#0000C0">[</font><font color="#000000">x</font><font color="#0000C0">]</font><font color="#0000C0">=</font><font color="#000000">bigword</font><font color="#0000C0">.</font><font color="#000000">count</font><font color="#0000C0">(</font><font color="#000000">target</font><font color="#0000C0">[</font><font color="#0000C0">:</font><font color="#0000C0">:</font><font color="#0000C0">-</font><font color="#0080C0">1</font><font color="#0000C0">]</font><font color="#0000C0">)</font> <font color="#008000"># Negative (or backward) solution</font>

<font color="#008000"># Check if there are any horizontal solutions</font>
<font color="#000000">hpos</font><font color="#0000C0">=</font><font color="#0000C0">[</font><font color="#0080C0">0</font><font color="#0000C0">]</font><font color="#0000C0">*</font><font color="#000000">NRows</font><font color="#0000C0">;</font> <font color="#000000">hneg</font><font color="#0000C0">=</font><font color="#0000C0">[</font><font color="#0080C0">0</font><font color="#0000C0">]</font><font color="#0000C0">*</font><font color="#000000">NRows</font>
<font color="#C00000">for</font> <font color="#000000">y</font> <font color="#C00000">in</font> <font color="#000000">xrange</font><font color="#0000C0">(</font><font color="#000000">NRows</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
    <font color="#000000">bigword</font><font color="#0000C0">=</font><font color="#004080">""</font><font color="#0000C0">.</font><font color="#000000">join</font><font color="#0000C0">(</font><font color="#000000">store</font><font color="#0000C0">[</font><font color="#000000">y</font><font color="#0000C0">,</font><font color="#0000C0">:</font><font color="#0000C0">]</font><font color="#0000C0">)</font>
    <font color="#000000">hpos</font><font color="#0000C0">[</font><font color="#000000">y</font><font color="#0000C0">]</font><font color="#0000C0">=</font><font color="#000000">bigword</font><font color="#0000C0">.</font><font color="#000000">count</font><font color="#0000C0">(</font><font color="#000000">target</font><font color="#0000C0">)</font> <font color="#008000"># Positive (or forward) solution</font>
    <font color="#000000">hneg</font><font color="#0000C0">[</font><font color="#000000">y</font><font color="#0000C0">]</font><font color="#0000C0">=</font><font color="#000000">bigword</font><font color="#0000C0">.</font><font color="#000000">count</font><font color="#0000C0">(</font><font color="#000000">target</font><font color="#0000C0">[</font><font color="#0000C0">:</font><font color="#0000C0">:</font><font color="#0000C0">-</font><font color="#0080C0">1</font><font color="#0000C0">]</font><font color="#0000C0">)</font> <font color="#008000"># Negative (or backward) solution</font>

<font color="#008000"># Print report about types of solutions found</font>
<font color="#000000">HorizPos</font><font color="#0000C0">=</font><font color="#000000">sum</font><font color="#0000C0">(</font><font color="#000000">hpos</font><font color="#0000C0">)</font>
<font color="#000000">HorizNeg</font><font color="#0000C0">=</font><font color="#000000">sum</font><font color="#0000C0">(</font><font color="#000000">hneg</font><font color="#0000C0">)</font>
<font color="#000000">VertPos</font><font color="#0000C0">=</font><font color="#000000">sum</font><font color="#0000C0">(</font><font color="#000000">vpos</font><font color="#0000C0">)</font>
<font color="#000000">VertNeg</font><font color="#0000C0">=</font><font color="#000000">sum</font><font color="#0000C0">(</font><font color="#000000">vneg</font><font color="#0000C0">)</font>
<font color="#C00000">print</font><font color="#0000C0">(</font><font color="#004080">"Horizontal, forward solutions: "</font><font color="#0000C0">+</font><font color="#000000">str</font><font color="#0000C0">(</font><font color="#000000">HorizPos</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<font color="#C00000">print</font><font color="#0000C0">(</font><font color="#004080">"Horizontal, backward solutions: "</font><font color="#0000C0">+</font><font color="#000000">str</font><font color="#0000C0">(</font><font color="#000000">HorizNeg</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<font color="#C00000">print</font><font color="#0000C0">(</font><font color="#004080">"Vertical, forward solutions: "</font><font color="#0000C0">+</font><font color="#000000">str</font><font color="#0000C0">(</font><font color="#000000">VertPos</font><font color="#0000C0">)</font><font color="#0000C0">)</font>
<font color="#C00000">print</font><font color="#0000C0">(</font><font color="#004080">"Vertical, backward solutions: "</font><font color="#0000C0">+</font><font color="#000000">str</font><font color="#0000C0">(</font><font color="#000000">VertNeg</font><font color="#0000C0">)</font><font color="#0000C0">)</font>

<font color="#C00000">def</font> <font color="#000000">listReport</font><font color="#0000C0">(</font><font color="#000000">pos</font><font color="#0000C0">,</font><font color="#000000">neg</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
    <font color="#004080">'''Generates a list reporting whether positive or negative values or both are present at each location in pos and neg'''</font>
    <font color="#000000">N</font><font color="#0000C0">=</font><font color="#000000">len</font><font color="#0000C0">(</font><font color="#000000">pos</font><font color="#0000C0">)</font>
    <font color="#000000">sol</font><font color="#0000C0">=</font><font color="#0000C0">[</font><font color="#004080">' '</font><font color="#0000C0">]</font><font color="#0000C0">*</font><font color="#000000">N</font>
    <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">xrange</font><font color="#0000C0">(</font><font color="#000000">N</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
        <font color="#C00000">if</font> <font color="#000000">pos</font><font color="#0000C0">[</font><font color="#000000">x</font><font color="#0000C0">]</font><font color="#0000C0">&gt;</font><font color="#0080C0">0</font><font color="#0000C0">:</font>
            <font color="#000000">sol</font><font color="#0000C0">[</font><font color="#000000">x</font><font color="#0000C0">]</font><font color="#0000C0">=</font><font color="#004080">"+"</font>
        <font color="#C00000">if</font> <font color="#000000">neg</font><font color="#0000C0">[</font><font color="#000000">x</font><font color="#0000C0">]</font><font color="#0000C0">&gt;</font><font color="#0080C0">0</font><font color="#0000C0">:</font>
            <font color="#000000">sol</font><font color="#0000C0">[</font><font color="#000000">x</font><font color="#0000C0">]</font><font color="#0000C0">=</font><font color="#004080">"-"</font>
        <font color="#C00000">if</font> <font color="#000000">neg</font><font color="#0000C0">[</font><font color="#000000">x</font><font color="#0000C0">]</font><font color="#0000C0">&gt;</font><font color="#0080C0">0</font> <font color="#C00000">and</font> <font color="#000000">pos</font><font color="#0000C0">[</font><font color="#000000">x</font><font color="#0000C0">]</font><font color="#0000C0">&gt;</font><font color="#0080C0">0</font><font color="#0000C0">:</font>
            <font color="#000000">sol</font><font color="#0000C0">[</font><font color="#000000">x</font><font color="#0000C0">]</font><font color="#0000C0">=</font><font color="#004080">"*"</font>
    <font color="#C00000">return</font><font color="#0000C0">(</font><font color="#000000">sol</font><font color="#0000C0">)</font>

<font color="#C00000">if</font> <font color="#000000">printsol</font><font color="#0000C0">:</font>
    <font color="#008000"># Show wordsearch and indicate solutions</font>
    <font color="#008000"># Don't do this if array is large...</font>
    <font color="#C00000">print</font><font color="#0000C0">(</font><font color="#004080">""</font><font color="#0000C0">)</font>
    <font color="#000000">hsol</font><font color="#0000C0">=</font><font color="#000000">listReport</font><font color="#0000C0">(</font><font color="#000000">hpos</font><font color="#0000C0">,</font><font color="#000000">hneg</font><font color="#0000C0">)</font>
    <font color="#000000">vsol</font><font color="#0000C0">=</font><font color="#000000">listReport</font><font color="#0000C0">(</font><font color="#000000">vpos</font><font color="#0000C0">,</font><font color="#000000">vneg</font><font color="#0000C0">)</font>
    <font color="#C00000">for</font> <font color="#000000">x</font> <font color="#C00000">in</font> <font color="#000000">xrange</font><font color="#0000C0">(</font><font color="#000000">NRows</font><font color="#0000C0">)</font><font color="#0000C0">:</font>
        <font color="#000000">output</font><font color="#0000C0">=</font><font color="#004080">""</font><font color="#0000C0">.</font><font color="#000000">join</font><font color="#0000C0">(</font><font color="#000000">store</font><font color="#0000C0">[</font><font color="#000000">x</font><font color="#0000C0">,</font><font color="#0000C0">:</font><font color="#0000C0">]</font><font color="#0000C0">)</font><font color="#0000C0">+</font><font color="#000000">hsol</font><font color="#0000C0">[</font><font color="#000000">x</font><font color="#0000C0">]</font>
        <font color="#C00000">print</font><font color="#0000C0">(</font><font color="#000000">output</font><font color="#0000C0">)</font>
    <font color="#C00000">print</font><font color="#0000C0">(</font><font color="#004080">""</font><font color="#0000C0">.</font><font color="#000000">join</font><font color="#0000C0">(</font><font color="#000000">vsol</font><font color="#0000C0">)</font><font color="#0000C0">)</font><font color="#000000"></font></font></pre>